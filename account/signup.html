<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>회원가입 - M&A STATION</title>
    <link rel="stylesheet" href="../assets/css/global.css" />
    <link rel="stylesheet" href="../assets/css/layout.css" />
    <link rel="stylesheet" href="../assets/css/components.css" />
    <link rel="stylesheet" href="../assets/css/responsive.css" />
    <style>
      /* Signup Page Specific Styles */
      .signup-page {
        min-height: 100vh;
        display: flex;
        align-items: flex-start;
        justify-content: center;
        padding: var(--spacing-xxl);
        padding-top: calc(var(--spacing-xxl) + 60px);
        background: var(--bg-primary);
        position: relative;
        overflow: visible;
      }

      .signup-page::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
          radial-gradient(circle at 20% 50%, rgba(77, 183, 255, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(77, 183, 255, 0.08) 0%, transparent 50%);
        pointer-events: none;
        z-index: 0;
      }

      .signup-container {
        position: relative;
        z-index: 1;
        width: 100%;
        max-width: 520px;
      }

      .signup-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--border-light);
        border-radius: 16px;
        padding: var(--spacing-xxl);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        margin-bottom: var(--spacing-xxl);
      }

      .signup-header {
        text-align: center;
        margin-bottom: var(--spacing-xxl);
      }

      .signup-header h1 {
        font-size: 28px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: var(--spacing-sm);
        letter-spacing: -0.5px;
      }

      .signup-header p {
        font-size: var(--font-size-small);
        color: var(--text-muted);
        opacity: 0.8;
      }

      .signup-form {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-lg);
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
      }

      .form-group label {
        font-size: var(--font-size-small);
        color: var(--text-secondary);
        font-weight: 500;
      }

      .form-group label .required {
        color: var(--accent-primary);
        margin-left: 4px;
      }

      .form-group input,
      .form-group select {
        width: 100%;
        padding: 14px 16px;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid var(--border-light);
        border-radius: 12px;
        color: var(--text-primary);
        font-size: var(--font-size-base);
        transition: all var(--transition-fast);
        box-sizing: border-box;
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: var(--accent-primary);
        background: rgba(255, 255, 255, 0.12);
        box-shadow: 0 0 0 3px rgba(77, 183, 255, 0.1);
      }

      .form-group input::placeholder {
        color: var(--text-muted);
        opacity: 0.5;
      }

      .form-group select {
        cursor: pointer;
      }

      .form-group select option {
        background: var(--bg-menu);
        color: var(--text-primary);
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-md);
      }

      .form-helper {
        font-size: var(--font-size-xs);
        color: var(--text-muted);
        opacity: 0.7;
        margin-top: -4px;
      }

      .form-checkbox {
        display: flex;
        align-items: flex-start;
        gap: var(--spacing-sm);
        padding: var(--spacing-md);
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-light);
        border-radius: 12px;
        cursor: pointer;
        transition: all var(--transition-fast);
      }

      .form-checkbox:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: var(--accent-primary);
      }

      .form-checkbox input[type="checkbox"] {
        width: auto;
        margin-top: 2px;
        cursor: pointer;
      }

      .form-checkbox label {
        font-size: var(--font-size-small);
        color: var(--text-secondary);
        cursor: pointer;
        flex: 1;
      }

      .form-checkbox a {
        color: var(--accent-primary);
        text-decoration: none;
      }

      .form-checkbox a:hover {
        text-decoration: underline;
      }

      .signup-btn {
        width: 100%;
        padding: 14px;
        background: rgba(77, 183, 255, 0.2);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(77, 183, 255, 0.3);
        border-radius: 12px;
        color: var(--accent-primary);
        font-size: var(--font-size-base);
        font-weight: 600;
        cursor: pointer;
        transition: all var(--transition-fast);
        box-shadow: 0 4px 12px rgba(77, 183, 255, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        margin-top: var(--spacing-md);
      }

      .signup-btn:hover {
        background: rgba(77, 183, 255, 0.3);
        border-color: rgba(77, 183, 255, 0.4);
        box-shadow: 0 6px 16px rgba(77, 183, 255, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15);
        transform: translateY(-1px);
      }

      .signup-btn:active {
        transform: translateY(0);
      }

      .signup-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      .login-link {
        text-align: center;
        margin-top: var(--spacing-xl);
        padding-top: var(--spacing-xl);
        border-top: 1px solid var(--border-light);
      }

      .login-link p {
        font-size: var(--font-size-small);
        color: var(--text-muted);
        margin-bottom: var(--spacing-md);
      }

      .login-link a {
        color: var(--accent-primary);
        text-decoration: none;
        font-weight: 600;
      }

      .login-link a:hover {
        text-decoration: underline;
      }

      .back-link {
        position: absolute;
        top: var(--spacing-xl);
        left: var(--spacing-xl);
        z-index: 10;
        color: var(--text-primary);
        text-decoration: none;
        font-size: var(--font-size-small);
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        opacity: 0.8;
        transition: opacity var(--transition-fast);
      }

      .back-link:hover {
        opacity: 1;
      }

      .sns-signup {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-xl);
        padding-bottom: var(--spacing-xl);
        border-bottom: 1px solid var(--border-light);
      }

      .sns-signup-title {
        text-align: center;
        font-size: var(--font-size-small);
        color: var(--text-muted);
        margin-bottom: var(--spacing-sm);
      }

      .sns-signup-title strong {
        color: var(--accent-primary);
        font-weight: 600;
      }

      .sns-buttons {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: var(--spacing-md);
      }

      .sns-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-md);
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid var(--border-light);
        border-radius: 12px;
        cursor: pointer;
        transition: all var(--transition-fast);
        text-decoration: none;
        color: var(--text-primary);
        gap: var(--spacing-xs);
        min-height: 80px;
      }

      .sns-btn:hover {
        background: rgba(255, 255, 255, 0.12);
        border-color: var(--accent-primary);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(77, 183, 255, 0.2);
      }

      .sns-btn:active {
        transform: translateY(0);
      }

      .sns-btn-icon {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        font-weight: 600;
        border-radius: 50%;
      }

      .sns-btn.naver .sns-btn-icon {
        background: #03C75A;
        color: white;
      }

      .sns-btn.kakao .sns-btn-icon {
        background: #FEE500;
        color: #000;
      }

      .sns-btn.google .sns-btn-icon {
        background: white;
        color: #4285F4;
      }

      .sns-btn-text {
        font-size: var(--font-size-xs);
        font-weight: 500;
        opacity: 0.9;
      }

      .divider {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        margin: var(--spacing-xl) 0;
        color: var(--text-muted);
        font-size: var(--font-size-xs);
      }

      .divider::before,
      .divider::after {
        content: '';
        flex: 1;
        height: 1px;
        background: var(--border-light);
      }

      @media (max-width: 600px) {
        .signup-page {
          padding: var(--spacing-lg);
          padding-top: calc(var(--spacing-lg) + 50px);
        }

        .signup-card {
          padding: var(--spacing-xl);
        }

        .signup-header h1 {
          font-size: 24px;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .back-link {
          top: var(--spacing-md);
          left: var(--spacing-md);
        }

        .sns-buttons {
          grid-template-columns: repeat(3, 1fr);
          gap: var(--spacing-sm);
        }

        .sns-btn {
          padding: var(--spacing-sm);
          min-height: 70px;
        }

        .sns-btn-icon {
          width: 28px;
          height: 28px;
          font-size: 20px;
        }

        .sns-btn-text {
          font-size: 10px;
        }
      }
    </style>
  </head>
  <body>
    <a href="../index.html" class="back-link">← 홈으로</a>
    
    <div class="signup-page">
      <div class="signup-container">
        <div class="signup-card">
          <div class="signup-header">
            <h1>회원가입</h1>
            <p>M&A STATION과 함께 시작하세요</p>
	</div>

          <div class="sns-signup">
            <div class="sns-signup-title">
              <strong>SNS 1초 회원가입</strong>으로 간편하게 시작하세요
							</div>
            <div class="sns-buttons">
              <a href="#" class="sns-btn naver" id="naverSignup">
                <div class="sns-btn-icon">N</div>
                <span class="sns-btn-text">네이버</span>
              </a>
              <a href="#" class="sns-btn kakao" id="kakaoSignup">
                <div class="sns-btn-icon">K</div>
                <span class="sns-btn-text">카카오</span>
              </a>
              <a href="#" class="sns-btn google" id="googleSignup">
                <div class="sns-btn-icon">G</div>
                <span class="sns-btn-text">구글</span>
              </a>
						   </div>
						</div>

          <div class="divider">또는</div>

          <form class="signup-form" id="signupForm">
            <div class="form-group">
              <label for="userId">아이디 <span class="required">*</span></label>
              <input 
                type="text" 
                id="userId" 
                name="userId" 
                placeholder="영문소문자/숫자, 4~16자"
                required
                pattern="[a-z0-9]{4,16}"
              />
              <div class="form-helper">영문소문자와 숫자만 사용 가능합니다 (4~16자)</div>
            </div>

            <div class="form-group">
              <label for="password">비밀번호 <span class="required">*</span></label>
              <input 
                type="password" 
                id="password" 
                name="password" 
                placeholder="비밀번호를 입력하세요"
                required
                minlength="8"
              />
              <div class="form-helper">영문, 숫자, 특수문자를 포함하여 8자 이상</div>
						</div>

            <div class="form-group">
              <label for="passwordConfirm">비밀번호 확인 <span class="required">*</span></label>
              <input 
                type="password" 
                id="passwordConfirm" 
                name="passwordConfirm" 
                placeholder="비밀번호를 다시 입력하세요"
                required
              />
								</div>

            <div class="form-row">
              <div class="form-group">
                <label for="name">이름 <span class="required">*</span></label>
                <input 
                  type="text" 
                  id="name" 
                  name="name" 
                  placeholder="이름"
                  required
                />
								</div>

              <div class="form-group">
                <label for="email">이메일 <span class="required">*</span></label>
                <input 
                  type="email" 
                  id="email" 
                  name="email" 
                  placeholder="example@email.com"
                  required
                />
						</div>
					</div>

            <div class="form-row">
              <div class="form-group">
                <label for="phone">휴대전화 <span class="required">*</span></label>
                <input 
                  type="tel" 
                  id="phone" 
                  name="phone" 
                  placeholder="010-0000-0000"
                  required
                />
	</div>

              <div class="form-group">
                <label for="companyType">기업형태</label>
                <select id="companyType" name="companyType">
                  <option value="">선택하세요</option>
                  <option value="small">중소기업</option>
                  <option value="medium">중견기업</option>
                  <option value="large">대기업</option>
                  <option value="startup">스타트업</option>
                </select>
                        </div>
                    </div>

            <div class="form-group">
              <label for="companyName">회사명</label>
              <input 
                type="text" 
                id="companyName" 
                name="companyName" 
                placeholder="회사명을 입력하세요"
              />
                    </div>

            <div class="form-checkbox">
              <input type="checkbox" id="agreeTerms" name="agreeTerms" required />
              <label for="agreeTerms">
                <a href="#terms">이용약관</a> 및 <a href="#privacy">개인정보처리방침</a>에 동의합니다 <span class="required">*</span>
              </label>
    </div>

            <div class="form-checkbox">
              <input type="checkbox" id="agreeMarketing" name="agreeMarketing" />
              <label for="agreeMarketing">
                마케팅 정보 수신에 동의합니다 (선택)
              </label>
    </div>

            <button type="submit" class="signup-btn">회원가입</button>
          </form>

          <div class="login-link">
            <p>이미 회원이신가요? <a href="login.html">로그인</a></p>
          </div>
        </div>
      </div>
    </div>

    <!-- Naver Login SDK -->
    <script type="text/javascript" src="https://static.nid.naver.com/js/naverLogin_implicit-1.0.3.js" charset="utf-8"></script>
    <!-- Kakao SDK -->
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <!-- Google Sign-In API -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script>
      // 데이터 저장 키
      const STORAGE_KEY = 'mna_station_members';
      const LOGIN_STATE_KEY = 'mna_station_current_user';

      // 회원 데이터 저장 함수
      function saveMemberData(memberData) {
        const members = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
        const newMember = {
          id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
          ...memberData,
          createdAt: new Date().toISOString()
        };
        members.push(newMember);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(members));
        return newMember;
      }

      // 회원가입 후 자동 로그인 처리 함수
      function autoLoginAfterSignup(userData) {
        // 로그인 상태에 사용자 정보 저장
        localStorage.setItem(LOGIN_STATE_KEY, JSON.stringify({
          ...userData,
          loginTime: new Date().toISOString()
        }));
      }

      // 일반 회원가입
      document.getElementById('signupForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const password = document.getElementById('password').value;
        const passwordConfirm = document.getElementById('passwordConfirm').value;
        
        if (password !== passwordConfirm) {
          alert('비밀번호가 일치하지 않습니다.');
          return;
        }
        
        // 회원가입 데이터 수집
        const formData = {
          userId: document.getElementById('userId').value,
          password: password, // 비밀번호 저장
          name: document.getElementById('name').value,
          email: document.getElementById('email').value,
          phone: document.getElementById('phone').value,
          companyType: document.getElementById('companyType').value,
          companyName: document.getElementById('companyName').value,
          agreeTerms: document.getElementById('agreeTerms').checked,
          agreeMarketing: document.getElementById('agreeMarketing').checked,
          provider: null // 일반 가입
        };
        
        // 데이터 저장
        try {
          const newMember = saveMemberData(formData);
          // 회원가입 후 자동 로그인
          autoLoginAfterSignup(newMember);
          alert('회원가입이 완료되었습니다! 자동으로 로그인됩니다.');
          // 메인 페이지로 이동
          window.location.href = '../index.html';
        } catch (error) {
          console.error('회원가입 저장 오류:', error);
          alert('회원가입 중 오류가 발생했습니다. 다시 시도해주세요.');
        }
      });

      // 비밀번호 확인 실시간 검증
      document.getElementById('passwordConfirm').addEventListener('input', function() {
        const password = document.getElementById('password').value;
        const passwordConfirm = this.value;
        
        if (passwordConfirm && password !== passwordConfirm) {
          this.setCustomValidity('비밀번호가 일치하지 않습니다.');
        } else {
          this.setCustomValidity('');
        }
      });

      // Naver Signup 초기화
      let naverSignup;
      function initNaverSignup() {
        naverSignup = new naver.LoginWithNaverId({
          clientId: "YOUR_NAVER_CLIENT_ID", // 네이버 개발자센터에서 발급받은 Client ID
          callbackUrl: window.location.origin + "/account/signup.html",
          isPopup: false,
          loginButton: { color: "green", type: 1, height: 0 }
        });
        naverSignup.init();
      }

      // Naver Signup 버튼 클릭
      document.getElementById('naverSignup').addEventListener('click', function(e) {
        e.preventDefault();
        if (!naverSignup) {
          initNaverSignup();
        }
        naverSignup.getLoginStatus(function(status) {
          if (status) {
            // 이미 로그인된 경우
            handleNaverSignup(naverSignup.user);
          } else {
            // 로그인 팝업 열기
            naverSignup.reprompt();
          }
        });
      });

      // Naver 회원가입 성공 처리
      function handleNaverSignup(user) {
        const userData = {
          userId: user.id,
          email: user.email,
          name: user.name,
          phone: user.mobile || '',
          companyType: '',
          companyName: '',
          agreeTerms: true,
          agreeMarketing: false,
          provider: 'naver'
        };
        
        // 데이터 저장
        try {
          const newMember = saveMemberData(userData);
          // 회원가입 후 자동 로그인
          autoLoginAfterSignup(newMember);
          alert('네이버로 회원가입이 완료되었습니다! 자동으로 로그인됩니다.');
          // 메인 페이지로 이동
          window.location.href = '../index.html';
        } catch (error) {
          console.error('네이버 회원가입 저장 오류:', error);
          alert('회원가입 중 오류가 발생했습니다.');
        }
      }

      // Kakao SDK 초기화
      Kakao.init('YOUR_KAKAO_APP_KEY'); // 카카오 개발자센터에서 발급받은 JavaScript 키
      
      // Kakao Signup 버튼 클릭
      document.getElementById('kakaoSignup').addEventListener('click', function(e) {
        e.preventDefault();
        
        if (!Kakao.Auth.getAccessToken()) {
          Kakao.Auth.login({
            success: function(authObj) {
              // 사용자 정보 가져오기
              Kakao.API.request({
                url: '/v2/user/me',
                success: function(res) {
                  const userData = {
                    userId: res.id.toString(),
                    email: res.kakao_account.email || '',
                    name: res.kakao_account.profile.nickname || '',
                    phone: res.kakao_account.phone_number || '',
                    companyType: '',
                    companyName: '',
                    agreeTerms: true,
                    agreeMarketing: false,
                    provider: 'kakao'
                  };
                  
                  // 데이터 저장
                  try {
                    const newMember = saveMemberData(userData);
                    // 회원가입 후 자동 로그인
                    autoLoginAfterSignup(newMember);
                    alert('카카오로 회원가입이 완료되었습니다! 자동으로 로그인됩니다.');
                    // 메인 페이지로 이동
                    window.location.href = '../index.html';
                  } catch (error) {
                    console.error('카카오 회원가입 저장 오류:', error);
                    alert('회원가입 중 오류가 발생했습니다.');
                  }
                },
                fail: function(error) {
                  console.error('카카오 사용자 정보 가져오기 실패:', error);
                }
              });
            },
            fail: function(err) {
              console.error('카카오 로그인 실패:', err);
            }
          });
        } else {
          // 이미 로그인된 경우
          Kakao.API.request({
            url: '/v2/user/me',
            success: function(res) {
              const userData = {
                userId: res.id.toString(),
                email: res.kakao_account.email || '',
                name: res.kakao_account.profile.nickname || '',
                phone: res.kakao_account.phone_number || '',
                companyType: '',
                companyName: '',
                agreeTerms: true,
                agreeMarketing: false,
                provider: 'kakao'
              };
              
              try {
                const newMember = saveMemberData(userData);
                // 회원가입 후 자동 로그인
                autoLoginAfterSignup(newMember);
                alert('카카오로 회원가입이 완료되었습니다! 자동으로 로그인됩니다.');
                // 메인 페이지로 이동
                window.location.href = '../index.html';
              } catch (error) {
                console.error('카카오 회원가입 저장 오류:', error);
                alert('회원가입 중 오류가 발생했습니다.');
              }
            }
          });
        }
      });

      // Google Sign-In 초기화
      window.onload = function() {
        google.accounts.id.initialize({
          client_id: "YOUR_GOOGLE_CLIENT_ID", // Google Cloud Console에서 발급받은 Client ID
          callback: handleGoogleSignup
        });
      };

      // Google Signup 버튼 클릭
      document.getElementById('googleSignup').addEventListener('click', function(e) {
        e.preventDefault();
        google.accounts.id.prompt((notification) => {
          if (notification.isNotDisplayed() || notification.isSkippedMoment()) {
            // 팝업이 표시되지 않거나 건너뛴 경우, 직접 로그인 팝업 열기
            google.accounts.oauth2.initTokenClient({
              client_id: "YOUR_GOOGLE_CLIENT_ID",
              scope: 'email profile',
              callback: function(response) {
                if (response.access_token) {
                  // 사용자 정보 가져오기
                  fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
                    headers: {
                      'Authorization': 'Bearer ' + response.access_token
                    }
                  })
                  .then(response => response.json())
                  .then(data => {
                    const userData = {
                      userId: data.id,
                      email: data.email,
                      name: data.name,
                      phone: '',
                      companyType: '',
                      companyName: '',
                      agreeTerms: true,
                      agreeMarketing: false,
                      provider: 'google'
                    };
                    
                    // 데이터 저장
                    try {
                      const newMember = saveMemberData(userData);
                      // 회원가입 후 자동 로그인
                      autoLoginAfterSignup(newMember);
                      alert('구글로 회원가입이 완료되었습니다! 자동으로 로그인됩니다.');
                      // 메인 페이지로 이동
                      window.location.href = '../index.html';
                    } catch (error) {
                      console.error('구글 회원가입 저장 오류:', error);
                      alert('회원가입 중 오류가 발생했습니다.');
                    }
                  });
                }
              }
            }).requestAccessToken();
          }
        });
      });

      // Google 회원가입 성공 처리
      function handleGoogleSignup(response) {
        // ID 토큰을 디코딩하여 사용자 정보 추출
        const payload = JSON.parse(atob(response.credential.split('.')[1]));
        const userData = {
          userId: payload.sub,
          email: payload.email,
          name: payload.name,
          phone: '',
          companyType: '',
          companyName: '',
          agreeTerms: true,
          agreeMarketing: false,
          provider: 'google'
        };
        
        // 데이터 저장
        try {
          const newMember = saveMemberData(userData);
          // 회원가입 후 자동 로그인
          autoLoginAfterSignup(newMember);
          alert('구글로 회원가입이 완료되었습니다! 자동으로 로그인됩니다.');
          // 메인 페이지로 이동
          window.location.href = '../index.html';
        } catch (error) {
          console.error('구글 회원가입 저장 오류:', error);
          alert('회원가입 중 오류가 발생했습니다.');
        }
      }

      // Naver Signup 자동 초기화 (콜백 URL로 돌아온 경우)
      window.addEventListener('load', function() {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('code') && urlParams.get('state')) {
          initNaverSignup();
        }
      });
    </script>
    <script src="../assets/js/header.js"></script>
    <script src="../assets/js/menu.js"></script>
  </body>
</html>
