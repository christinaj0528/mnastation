<!DOCTYPE html>
<html lang="ko" class="fullpage">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>로그인 - M&A STATION</title>
    <link rel="stylesheet" href="../assets/css/global.css" />
    <link rel="stylesheet" href="../assets/css/layout.css" />
    <link rel="stylesheet" href="../assets/css/components.css" />
    <link rel="stylesheet" href="../assets/css/responsive.css" />
    <style>
      /* Login Page Specific Styles */
      .login-page {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-xxl);
        background: var(--bg-primary);
        position: relative;
        overflow: hidden;
      }

      .login-page::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
          radial-gradient(circle at 20% 50%, rgba(77, 183, 255, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(77, 183, 255, 0.08) 0%, transparent 50%);
        pointer-events: none;
        z-index: 0;
      }

      .login-container {
        position: relative;
        z-index: 1;
        width: 100%;
        max-width: 440px;
      }

      .login-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--border-light);
        border-radius: 16px;
        padding: var(--spacing-xxl);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      }

      .login-header {
        text-align: center;
        margin-bottom: var(--spacing-xxl);
      }

      .login-header h1 {
        font-size: 28px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: var(--spacing-sm);
        letter-spacing: -0.5px;
      }

      .login-header p {
        font-size: var(--font-size-small);
        color: var(--text-muted);
        opacity: 0.8;
      }

      .login-form {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-lg);
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
      }

      .form-group label {
        font-size: var(--font-size-small);
        color: var(--text-secondary);
        font-weight: 500;
      }

      .form-group input {
        width: 100%;
        padding: 14px 16px;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid var(--border-light);
        border-radius: 12px;
        color: var(--text-primary);
        font-size: var(--font-size-base);
        transition: all var(--transition-fast);
        box-sizing: border-box;
      }

      .form-group input:focus {
        outline: none;
        border-color: var(--accent-primary);
        background: rgba(255, 255, 255, 0.12);
        box-shadow: 0 0 0 3px rgba(77, 183, 255, 0.1);
      }

      .form-group input::placeholder {
        color: var(--text-muted);
        opacity: 0.5;
      }

      .form-options {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: var(--font-size-xs);
        color: var(--text-muted);
      }

      .form-options label {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        cursor: pointer;
      }

      .form-options input[type="checkbox"] {
        width: auto;
        cursor: pointer;
      }

      .form-options a {
        color: var(--accent-primary);
        text-decoration: none;
        transition: opacity var(--transition-fast);
      }

      .form-options a:hover {
        opacity: 0.8;
      }

      .login-btn {
        width: 100%;
        padding: 14px;
        background: rgba(77, 183, 255, 0.2);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(77, 183, 255, 0.3);
        border-radius: 12px;
        color: var(--accent-primary);
        font-size: var(--font-size-base);
        font-weight: 600;
        cursor: pointer;
        transition: all var(--transition-fast);
        box-shadow: 0 4px 12px rgba(77, 183, 255, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        margin-top: var(--spacing-md);
      }

      .login-btn:hover {
        background: rgba(77, 183, 255, 0.3);
        border-color: rgba(77, 183, 255, 0.4);
        box-shadow: 0 6px 16px rgba(77, 183, 255, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15);
        transform: translateY(-1px);
      }

      .login-btn:active {
        transform: translateY(0);
      }

      .divider {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        margin: var(--spacing-xl) 0;
        color: var(--text-muted);
        font-size: var(--font-size-xs);
      }

      .divider::before,
      .divider::after {
        content: '';
        flex: 1;
        height: 1px;
        background: var(--border-light);
      }

      .sns-login {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
        margin-top: var(--spacing-lg);
      }

      .sns-login-title {
        text-align: center;
        font-size: var(--font-size-xs);
        color: var(--text-muted);
        margin-bottom: var(--spacing-sm);
      }

      .sns-buttons {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: var(--spacing-md);
      }

      .sns-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-md);
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid var(--border-light);
        border-radius: 12px;
        cursor: pointer;
        transition: all var(--transition-fast);
        text-decoration: none;
        color: var(--text-primary);
        gap: var(--spacing-xs);
        min-height: 80px;
      }

      .sns-btn:hover {
        background: rgba(255, 255, 255, 0.12);
        border-color: var(--accent-primary);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(77, 183, 255, 0.2);
      }

      .sns-btn:active {
        transform: translateY(0);
      }

      .sns-btn-icon {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        font-weight: 600;
        border-radius: 50%;
      }

      .sns-btn.naver .sns-btn-icon {
        background: #03C75A;
        color: white;
      }

      .sns-btn.kakao .sns-btn-icon {
        background: #FEE500;
        color: #000;
      }

      .sns-btn.google .sns-btn-icon {
        background: white;
        color: #4285F4;
      }

      .sns-btn-text {
        font-size: var(--font-size-xs);
        font-weight: 500;
        opacity: 0.9;
      }

      @media (max-width: 600px) {
        .sns-buttons {
          grid-template-columns: repeat(3, 1fr);
          gap: var(--spacing-sm);
        }

        .sns-btn {
          padding: var(--spacing-sm);
          min-height: 70px;
        }

        .sns-btn-icon {
          width: 28px;
          height: 28px;
          font-size: 20px;
        }

        .sns-btn-text {
          font-size: 10px;
        }
      }

      .signup-link {
        text-align: center;
        margin-top: var(--spacing-xl);
        padding-top: var(--spacing-xl);
        border-top: 1px solid var(--border-light);
      }

      .signup-link p {
        font-size: var(--font-size-small);
        color: var(--text-muted);
        margin-bottom: var(--spacing-md);
      }

      .signup-link a {
        display: inline-block;
        padding: 12px 24px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.18);
        border-radius: 12px;
        color: var(--text-primary);
        text-decoration: none;
        font-weight: 600;
        font-size: var(--font-size-small);
        transition: all var(--transition-fast);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2);
      }

      .signup-link a:hover {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.25);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.3);
        transform: translateY(-1px);
      }

      .back-link {
        position: absolute;
        top: var(--spacing-xl);
        left: var(--spacing-xl);
        z-index: 10;
        color: var(--text-primary);
        text-decoration: none;
        font-size: var(--font-size-small);
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        opacity: 0.8;
        transition: opacity var(--transition-fast);
      }

      .back-link:hover {
        opacity: 1;
      }

      @media (max-width: 600px) {
        .login-page {
          padding: var(--spacing-lg);
        }

        .login-card {
          padding: var(--spacing-xl);
        }

        .login-header h1 {
          font-size: 24px;
        }

        .back-link {
          top: var(--spacing-md);
          left: var(--spacing-md);
        }
      }
    </style>
  </head>
  <body>
    <a href="../index.html" class="back-link">← 홈으로</a>
    
    <div class="login-page">
      <div class="login-container">
        <div class="login-card">
          <div class="login-header">
            <h1>로그인</h1>
            <p>M&A STATION에 오신 것을 환영합니다</p>
</div>

          <form class="login-form" id="loginForm">
            <div class="form-group">
              <label for="userId">아이디</label>
              <input 
                type="text" 
                id="userId" 
                name="userId" 
                placeholder="아이디를 입력하세요"
                required
              />
</div>

            <div class="form-group">
              <label for="password">비밀번호</label>
              <input 
                type="password" 
                id="password" 
                name="password" 
                placeholder="비밀번호를 입력하세요"
                required
              />
		</div>

            <div class="form-options">
              <label>
                <input type="checkbox" name="saveId" />
                <span>아이디 저장</span>
              </label>
              <div>
                <a href="#findId">아이디 찾기</a>
                <span style="margin: 0 8px; opacity: 0.5;">|</span>
                <a href="#findPassword">비밀번호 찾기</a>
		</div>
		</div>

            <button type="submit" class="login-btn">로그인</button>
          </form>

          <div class="divider">또는</div>

          <div class="sns-login">
            <div class="sns-login-title">SNS 1초 로그인</div>
            <div class="sns-buttons">
              <a href="#" class="sns-btn naver" id="naverLogin">
                <div class="sns-btn-icon">N</div>
                <span class="sns-btn-text">네이버</span>
              </a>
              <a href="#" class="sns-btn kakao" id="kakaoLogin">
                <div class="sns-btn-icon">K</div>
                <span class="sns-btn-text">카카오</span>
              </a>
              <a href="#" class="sns-btn google" id="googleLogin">
                <div class="sns-btn-icon">G</div>
                <span class="sns-btn-text">구글</span>
              </a>
			</div>
</div>

          <div class="signup-link">
            <p>아직 회원이 아니신가요?</p>
            <a href="signup.html">회원가입</a>
            </div>
        </div>
    </div>
</div>

    <!-- Naver Login SDK -->
    <script type="text/javascript" src="https://static.nid.naver.com/js/naverLogin_implicit-1.0.3.js" charset="utf-8"></script>
    <!-- Kakao SDK -->
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <!-- Google Sign-In API -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script>
      // 로그인 상태 키
      const LOGIN_STATE_KEY = 'mna_station_current_user';
      const MEMBERS_STORAGE_KEY = 'mna_station_members';

      // 일반 로그인
      document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const userId = document.getElementById('userId').value;
        const password = document.getElementById('password').value;
        
        // 회원 데이터에서 사용자 찾기
        const members = JSON.parse(localStorage.getItem(MEMBERS_STORAGE_KEY) || '[]');
        const user = members.find(m => m.userId === userId);
        
        if (user) {
          // 로그인 성공 - 현재 사용자 정보 저장
          localStorage.setItem(LOGIN_STATE_KEY, JSON.stringify({
            ...user,
            loginTime: new Date().toISOString()
          }));
          
          alert('로그인 성공!');
          window.location.href = '../index.html';
        } else {
          alert('아이디 또는 비밀번호가 올바르지 않습니다.');
        }
      });

      // Naver Login 초기화
      let naverLogin;
      function initNaverLogin() {
        naverLogin = new naver.LoginWithNaverId({
          clientId: "YOUR_NAVER_CLIENT_ID", // 네이버 개발자센터에서 발급받은 Client ID
          callbackUrl: window.location.origin + "/account/login.html",
          isPopup: false,
          loginButton: { color: "green", type: 1, height: 0 }
        });
        naverLogin.init();
      }

      // Naver Login 버튼 클릭
      document.getElementById('naverLogin').addEventListener('click', function(e) {
        e.preventDefault();
        if (!naverLogin) {
          initNaverLogin();
        }
        naverLogin.getLoginStatus(function(status) {
          if (status) {
            // 이미 로그인된 경우
            handleNaverLogin(naverLogin.user);
          } else {
            // 로그인 팝업 열기
            naverLogin.reprompt();
          }
        });
      });

      // Naver 로그인 성공 처리
      function handleNaverLogin(user) {
        const userData = {
          userId: user.id,
          email: user.email,
          name: user.name,
          phone: user.mobile || '',
          provider: 'naver'
        };
        
        // 회원 데이터에서 사용자 찾기 또는 생성
        const members = JSON.parse(localStorage.getItem(MEMBERS_STORAGE_KEY) || '[]');
        let existingUser = members.find(m => m.userId === userData.userId && m.provider === 'naver');
        
        if (!existingUser) {
          // 신규 회원인 경우 회원가입 처리
          existingUser = {
            id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
            ...userData,
            createdAt: new Date().toISOString()
          };
          members.push(existingUser);
          localStorage.setItem(MEMBERS_STORAGE_KEY, JSON.stringify(members));
        }
        
        // 현재 로그인 사용자 정보 저장
        localStorage.setItem(LOGIN_STATE_KEY, JSON.stringify({
          ...existingUser,
          loginTime: new Date().toISOString()
        }));
        
        alert('네이버 로그인 성공!');
        window.location.href = '../index.html';
      }

      // Kakao SDK 초기화
      Kakao.init('YOUR_KAKAO_APP_KEY'); // 카카오 개발자센터에서 발급받은 JavaScript 키
      
      // Kakao Login 버튼 클릭
      document.getElementById('kakaoLogin').addEventListener('click', function(e) {
        e.preventDefault();
        
        if (!Kakao.Auth.getAccessToken()) {
          Kakao.Auth.login({
            success: function(authObj) {
              // 사용자 정보 가져오기
              Kakao.API.request({
                url: '/v2/user/me',
                success: function(res) {
                  const userData = {
                    userId: res.id.toString(),
                    email: res.kakao_account.email || '',
                    name: res.kakao_account.profile.nickname || '',
                    phone: res.kakao_account.phone_number || '',
                    provider: 'kakao'
                  };
                  
                  // 회원 데이터에서 사용자 찾기 또는 생성
                  const members = JSON.parse(localStorage.getItem(MEMBERS_STORAGE_KEY) || '[]');
                  let existingUser = members.find(m => m.userId === userData.userId && m.provider === 'kakao');
                  
                  if (!existingUser) {
                    // 신규 회원인 경우 회원가입 처리
                    existingUser = {
                      id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                      ...userData,
                      createdAt: new Date().toISOString()
                    };
                    members.push(existingUser);
                    localStorage.setItem(MEMBERS_STORAGE_KEY, JSON.stringify(members));
                  }
                  
                  // 현재 로그인 사용자 정보 저장
                  localStorage.setItem(LOGIN_STATE_KEY, JSON.stringify({
                    ...existingUser,
                    loginTime: new Date().toISOString()
                  }));
                  
                  alert('카카오 로그인 성공!');
                  window.location.href = '../index.html';
                },
                fail: function(error) {
                  console.error('카카오 사용자 정보 가져오기 실패:', error);
                }
              });
            },
            fail: function(err) {
              console.error('카카오 로그인 실패:', err);
            }
          });
        } else {
          // 이미 로그인된 경우
          Kakao.API.request({
            url: '/v2/user/me',
            success: function(res) {
              const userData = {
                userId: res.id.toString(),
                email: res.kakao_account.email || '',
                name: res.kakao_account.profile.nickname || '',
                phone: res.kakao_account.phone_number || '',
                provider: 'kakao'
              };
              
              const members = JSON.parse(localStorage.getItem(MEMBERS_STORAGE_KEY) || '[]');
              let existingUser = members.find(m => m.userId === userData.userId && m.provider === 'kakao');
              
              if (!existingUser) {
                existingUser = {
                  id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                  ...userData,
                  createdAt: new Date().toISOString()
                };
                members.push(existingUser);
                localStorage.setItem(MEMBERS_STORAGE_KEY, JSON.stringify(members));
              }
              
              localStorage.setItem(LOGIN_STATE_KEY, JSON.stringify({
                ...existingUser,
                loginTime: new Date().toISOString()
              }));
              
              alert('카카오 로그인 성공!');
              window.location.href = '../index.html';
            }
          });
        }
      });

      // Google Sign-In 초기화
      window.onload = function() {
        google.accounts.id.initialize({
          client_id: "YOUR_GOOGLE_CLIENT_ID", // Google Cloud Console에서 발급받은 Client ID
          callback: handleGoogleLogin
        });
      };

      // Google Login 버튼 클릭
      document.getElementById('googleLogin').addEventListener('click', function(e) {
        e.preventDefault();
        google.accounts.id.prompt((notification) => {
          if (notification.isNotDisplayed() || notification.isSkippedMoment()) {
            // 팝업이 표시되지 않거나 건너뛴 경우, 직접 로그인 팝업 열기
            google.accounts.oauth2.initTokenClient({
              client_id: "YOUR_GOOGLE_CLIENT_ID",
              scope: 'email profile',
              callback: function(response) {
                if (response.access_token) {
                  // 사용자 정보 가져오기
                  fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
                    headers: {
                      'Authorization': 'Bearer ' + response.access_token
                    }
                  })
                  .then(response => response.json())
                  .then(data => {
                    const userData = {
                      userId: data.id,
                      email: data.email,
                      name: data.name,
                      phone: '',
                      provider: 'google'
                    };
                    
                    const members = JSON.parse(localStorage.getItem(MEMBERS_STORAGE_KEY) || '[]');
                    let existingUser = members.find(m => m.userId === userData.userId && m.provider === 'google');
                    
                    if (!existingUser) {
                      existingUser = {
                        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                        ...userData,
                        createdAt: new Date().toISOString()
                      };
                      members.push(existingUser);
                      localStorage.setItem(MEMBERS_STORAGE_KEY, JSON.stringify(members));
                    }
                    
                    localStorage.setItem(LOGIN_STATE_KEY, JSON.stringify({
                      ...existingUser,
                      loginTime: new Date().toISOString()
                    }));
                    
                    alert('구글 로그인 성공!');
                    window.location.href = '../index.html';
                  });
                }
              }
            }).requestAccessToken();
          }
        });
      });

      // Google 로그인 성공 처리
      function handleGoogleLogin(response) {
        // ID 토큰을 디코딩하여 사용자 정보 추출
        const payload = JSON.parse(atob(response.credential.split('.')[1]));
        const userData = {
          userId: payload.sub,
          email: payload.email,
          name: payload.name,
          phone: '',
          provider: 'google'
        };
        
        const members = JSON.parse(localStorage.getItem(MEMBERS_STORAGE_KEY) || '[]');
        let existingUser = members.find(m => m.userId === userData.userId && m.provider === 'google');
        
        if (!existingUser) {
          existingUser = {
            id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
            ...userData,
            createdAt: new Date().toISOString()
          };
          members.push(existingUser);
          localStorage.setItem(MEMBERS_STORAGE_KEY, JSON.stringify(members));
        }
        
        localStorage.setItem(LOGIN_STATE_KEY, JSON.stringify({
          ...existingUser,
          loginTime: new Date().toISOString()
        }));
        
        alert('구글 로그인 성공!');
        window.location.href = '../index.html';
      }

      // Naver Login 자동 초기화 (콜백 URL로 돌아온 경우)
      window.addEventListener('load', function() {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('code') && urlParams.get('state')) {
          initNaverLogin();
        }
      });
    </script>
    <script src="../assets/js/header.js"></script>
    <script src="../assets/js/menu.js"></script>
  </body>
</html>
