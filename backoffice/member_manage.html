<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íšŒì› ê´€ë¦¬ - M&A STATION</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Malgun Gothic", "Apple SD Gothic Neo", sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 30px;
    }

    h1 {
      font-size: 28px;
      color: #333;
      margin-bottom: 30px;
      padding-bottom: 15px;
      border-bottom: 2px solid #4db7ff;
    }

    .stats-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .stat-card:nth-child(2) {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .stat-card:nth-child(3) {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .stat-card:nth-child(4) {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    }

    .stat-label {
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 8px;
    }

    .stat-value {
      font-size: 32px;
      font-weight: bold;
    }

    .filter-section {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      flex-wrap: wrap;
      align-items: center;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .filter-group label {
      font-size: 14px;
      color: #666;
      white-space: nowrap;
    }

    .filter-group select,
    .filter-group input {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }

    .filter-group input {
      min-width: 200px;
    }

    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s;
    }

    .btn-primary {
      background: #4db7ff;
      color: white;
    }

    .btn-primary:hover {
      background: #1f6fe5;
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
    }

    .btn-danger {
      background: #dc3545;
      color: white;
    }

    .btn-danger:hover {
      background: #c82333;
    }

    .btn-sm {
      padding: 4px 8px;
      font-size: 12px;
    }

    .table-container {
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    thead {
      background: #f8f9fa;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #dee2e6;
    }

    th {
      font-weight: 600;
      color: #333;
      font-size: 14px;
      cursor: pointer;
      user-select: none;
    }

    th:hover {
      background: #e9ecef;
    }

    td {
      font-size: 13px;
      color: #666;
    }

    tbody tr:hover {
      background: #f8f9fa;
    }

    .provider-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }

    .provider-normal {
      background: #e9ecef;
      color: #495057;
    }

    .provider-naver {
      background: #03c75a;
      color: white;
    }

    .provider-kakao {
      background: #fee500;
      color: #000;
    }

    .provider-google {
      background: #4285f4;
      color: white;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }

    .empty-state-icon {
      font-size: 48px;
      margin-bottom: 15px;
      opacity: 0.5;
    }

    .action-buttons {
      display: flex;
      gap: 5px;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 8px;
      padding: 30px;
      max-width: 700px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #dee2e6;
    }

    .modal-title {
      font-size: 20px;
      font-weight: 600;
      color: #333;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
    }

    .modal-close:hover {
      color: #333;
    }

    .modal-body {
      margin-bottom: 20px;
    }

    .info-row {
      display: flex;
      margin-bottom: 15px;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 4px;
    }

    .info-label {
      width: 120px;
      font-weight: 600;
      color: #666;
      font-size: 14px;
    }

    .info-value {
      flex: 1;
      color: #333;
      font-size: 14px;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      padding-top: 20px;
      border-top: 1px solid #dee2e6;
    }

    .pagination {
      display: flex;
      justify-content: center;
      gap: 5px;
      margin-top: 20px;
    }

    .pagination button {
      padding: 8px 12px;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      border-radius: 4px;
    }

    .pagination button:hover:not(:disabled) {
      background: #f8f9fa;
    }

    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .pagination button.active {
      background: #4db7ff;
      color: white;
      border-color: #4db7ff;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>íšŒì› ê´€ë¦¬</h1>

    <!-- í†µê³„ ì„¹ì…˜ -->
    <div class="stats-section">
      <div class="stat-card">
        <div class="stat-label">ì „ì²´ íšŒì›</div>
        <div class="stat-value" id="totalMembers">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">ì¼ë°˜ íšŒì›</div>
        <div class="stat-value" id="normalMembers">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">SNS íšŒì›</div>
        <div class="stat-value" id="snsMembers">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">ì˜¤ëŠ˜ ê°€ì…</div>
        <div class="stat-value" id="todayMembers">0</div>
      </div>
    </div>

    <!-- í•„í„° ì„¹ì…˜ -->
    <div class="filter-section">
      <div class="filter-group">
        <label>ê²€ìƒ‰:</label>
        <input type="text" id="searchInput" placeholder="ì•„ì´ë””, ì´ë¦„, ì´ë©”ì¼ë¡œ ê²€ìƒ‰">
      </div>
      <div class="filter-group">
        <label>ê°€ì…ë°©ì‹:</label>
        <select id="providerFilter">
          <option value="">ì „ì²´</option>
          <option value="null">ì¼ë°˜</option>
          <option value="naver">ë„¤ì´ë²„</option>
          <option value="kakao">ì¹´ì¹´ì˜¤</option>
          <option value="google">êµ¬ê¸€</option>
        </select>
      </div>
      <div class="filter-group">
        <label>ì •ë ¬:</label>
        <select id="sortSelect">
          <option value="createdAt-desc">ê°€ì…ì¼ ìµœì‹ ìˆœ</option>
          <option value="createdAt-asc">ê°€ì…ì¼ ì˜¤ë˜ëœìˆœ</option>
          <option value="name-asc">ì´ë¦„ ê°€ë‚˜ë‹¤ìˆœ</option>
          <option value="userId-asc">ì•„ì´ë”” ê°€ë‚˜ë‹¤ìˆœ</option>
        </select>
      </div>
      <button class="btn btn-secondary" onclick="resetFilters()">ì´ˆê¸°í™”</button>
      <button class="btn btn-primary" onclick="exportData()">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
    </div>

    <!-- í…Œì´ë¸” ì„¹ì…˜ -->
    <div class="table-container">
      <table id="memberTable">
        <thead>
          <tr>
            <th onclick="sortTable('id')">ë²ˆí˜¸</th>
            <th onclick="sortTable('userId')">ì•„ì´ë””</th>
            <th onclick="sortTable('name')">ì´ë¦„</th>
            <th onclick="sortTable('email')">ì´ë©”ì¼</th>
            <th onclick="sortTable('phone')">ì „í™”ë²ˆí˜¸</th>
            <th onclick="sortTable('companyType')">íšŒì‚¬ìœ í˜•</th>
            <th onclick="sortTable('companyName')">íšŒì‚¬ëª…</th>
            <th onclick="sortTable('provider')">ê°€ì…ë°©ì‹</th>
            <th onclick="sortTable('createdAt')">ê°€ì…ì¼</th>
            <th>ê´€ë¦¬</th>
          </tr>
        </thead>
        <tbody id="memberTableBody">
          <tr>
            <td colspan="10" class="empty-state">
              <div class="empty-state-icon">ğŸ‘¤</div>
              <div>ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
    <div class="pagination" id="pagination"></div>
  </div>

  <!-- ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
  <div class="modal" id="detailModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">íšŒì› ìƒì„¸ ì •ë³´</div>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- ìƒì„¸ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal()">ë‹«ê¸°</button>
        <button class="btn btn-danger" onclick="deleteMember()">íšŒì› ì‚­ì œ</button>
      </div>
    </div>
  </div>

  <script>
    const STORAGE_KEY = 'mna_station_members';
    let allMembers = [];
    let filteredMembers = [];
    let currentPage = 1;
    const itemsPerPage = 20;
    let currentSort = { field: 'createdAt', order: 'desc' };
    let selectedMemberId = null;

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    document.addEventListener('DOMContentLoaded', function() {
      loadMembers();
      setupEventListeners();
    });

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    function setupEventListeners() {
      document.getElementById('searchInput').addEventListener('input', filterMembers);
      document.getElementById('providerFilter').addEventListener('change', filterMembers);
      document.getElementById('sortSelect').addEventListener('change', function() {
        const [field, order] = this.value.split('-');
        currentSort = { field, order };
        sortAndDisplay();
      });
    }

    // íšŒì› ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    function loadMembers() {
      try {
        const membersData = localStorage.getItem(STORAGE_KEY);
        allMembers = membersData ? JSON.parse(membersData) : [];
        
        // ë¹„ë°€ë²ˆí˜¸ í•„ë“œëŠ” í‘œì‹œí•˜ì§€ ì•ŠìŒ (ë³´ì•ˆ)
        allMembers = allMembers.map(member => {
          const { password, ...memberWithoutPassword } = member;
          return memberWithoutPassword;
        });

        updateStats();
        filterMembers();
      } catch (error) {
        console.error('íšŒì› ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
        alert('íšŒì› ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    }

    // í†µê³„ ì—…ë°ì´íŠ¸
    function updateStats() {
      const total = allMembers.length;
      const normal = allMembers.filter(m => !m.provider || m.provider === 'null').length;
      const sns = allMembers.filter(m => m.provider && m.provider !== 'null').length;
      
      const today = new Date().toISOString().split('T')[0];
      const todayCount = allMembers.filter(m => {
        if (!m.createdAt) return false;
        const memberDate = new Date(m.createdAt).toISOString().split('T')[0];
        return memberDate === today;
      }).length;

      document.getElementById('totalMembers').textContent = total;
      document.getElementById('normalMembers').textContent = normal;
      document.getElementById('snsMembers').textContent = sns;
      document.getElementById('todayMembers').textContent = todayCount;
    }

    // í•„í„°ë§
    function filterMembers() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const providerFilter = document.getElementById('providerFilter').value;

      filteredMembers = allMembers.filter(member => {
        // ê²€ìƒ‰ì–´ í•„í„°
        const matchesSearch = !searchTerm || 
          (member.userId && member.userId.toLowerCase().includes(searchTerm)) ||
          (member.name && member.name.toLowerCase().includes(searchTerm)) ||
          (member.email && member.email.toLowerCase().includes(searchTerm));

        // ê°€ì…ë°©ì‹ í•„í„°
        let matchesProvider = true;
        if (providerFilter !== '') {
          if (providerFilter === 'null') {
            matchesProvider = !member.provider || member.provider === 'null';
          } else {
            matchesProvider = member.provider === providerFilter;
          }
        }

        return matchesSearch && matchesProvider;
      });

      currentPage = 1;
      sortAndDisplay();
    }

    // ì •ë ¬ ë° í‘œì‹œ
    function sortAndDisplay() {
      // ì •ë ¬
      filteredMembers.sort((a, b) => {
        let aVal = a[currentSort.field] || '';
        let bVal = b[currentSort.field] || '';

        if (currentSort.field === 'createdAt') {
          aVal = new Date(aVal).getTime();
          bVal = new Date(bVal).getTime();
        } else {
          aVal = String(aVal).toLowerCase();
          bVal = String(bVal).toLowerCase();
        }

        if (currentSort.order === 'asc') {
          return aVal > bVal ? 1 : aVal < bVal ? -1 : 0;
        } else {
          return aVal < bVal ? 1 : aVal > bVal ? -1 : 0;
        }
      });

      displayMembers();
      displayPagination();
    }

    // í…Œì´ë¸” ì •ë ¬
    function sortTable(field) {
      if (currentSort.field === field) {
        currentSort.order = currentSort.order === 'asc' ? 'desc' : 'asc';
      } else {
        currentSort.field = field;
        currentSort.order = 'asc';
      }
      sortAndDisplay();
    }

    // íšŒì› ëª©ë¡ í‘œì‹œ
    function displayMembers() {
      const tbody = document.getElementById('memberTableBody');
      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageMembers = filteredMembers.slice(start, end);

      if (pageMembers.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="10" class="empty-state">
              <div class="empty-state-icon">ğŸ”</div>
              <div>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = pageMembers.map((member, index) => {
        const rowNum = start + index + 1;
        const providerBadge = getProviderBadge(member.provider);
        const createdAt = member.createdAt ? new Date(member.createdAt).toLocaleString('ko-KR') : '-';
        
        return `
          <tr>
            <td>${rowNum}</td>
            <td>${member.userId || '-'}</td>
            <td>${member.name || '-'}</td>
            <td>${member.email || '-'}</td>
            <td>${member.phone || '-'}</td>
            <td>${member.companyType || '-'}</td>
            <td>${member.companyName || '-'}</td>
            <td>${providerBadge}</td>
            <td>${createdAt}</td>
            <td>
              <div class="action-buttons">
                <button class="btn btn-primary btn-sm" onclick="showMemberDetail('${member.id}')">ìƒì„¸</button>
              </div>
            </td>
          </tr>
        `;
      }).join('');
    }

    // ê°€ì…ë°©ì‹ ë±ƒì§€
    function getProviderBadge(provider) {
      if (!provider || provider === 'null') {
        return '<span class="provider-badge provider-normal">ì¼ë°˜</span>';
      }
      const badges = {
        'naver': '<span class="provider-badge provider-naver">ë„¤ì´ë²„</span>',
        'kakao': '<span class="provider-badge provider-kakao">ì¹´ì¹´ì˜¤</span>',
        'google': '<span class="provider-badge provider-google">êµ¬ê¸€</span>'
      };
      return badges[provider] || '<span class="provider-badge provider-normal">ì¼ë°˜</span>';
    }

    // í˜ì´ì§€ë„¤ì´ì…˜ í‘œì‹œ
    function displayPagination() {
      const totalPages = Math.ceil(filteredMembers.length / itemsPerPage);
      const pagination = document.getElementById('pagination');

      if (totalPages <= 1) {
        pagination.innerHTML = '';
        return;
      }

      let html = '';
      html += `<button ${currentPage === 1 ? 'disabled' : ''} onclick="goToPage(${currentPage - 1})">ì´ì „</button>`;

      for (let i = 1; i <= totalPages; i++) {
        if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
          html += `<button class="${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
        } else if (i === currentPage - 3 || i === currentPage + 3) {
          html += `<button disabled>...</button>`;
        }
      }

      html += `<button ${currentPage === totalPages ? 'disabled' : ''} onclick="goToPage(${currentPage + 1})">ë‹¤ìŒ</button>`;
      pagination.innerHTML = html;
    }

    // í˜ì´ì§€ ì´ë™
    function goToPage(page) {
      const totalPages = Math.ceil(filteredMembers.length / itemsPerPage);
      if (page >= 1 && page <= totalPages) {
        currentPage = page;
        displayMembers();
        displayPagination();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }

    // íšŒì› ìƒì„¸ ì •ë³´ í‘œì‹œ
    function showMemberDetail(memberId) {
      const member = allMembers.find(m => m.id === memberId);
      if (!member) {
        alert('íšŒì› ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }

      selectedMemberId = memberId;
      const modalBody = document.getElementById('modalBody');
      const createdAt = member.createdAt ? new Date(member.createdAt).toLocaleString('ko-KR') : '-';
      const providerText = !member.provider || member.provider === 'null' ? 'ì¼ë°˜' : 
                          member.provider === 'naver' ? 'ë„¤ì´ë²„' :
                          member.provider === 'kakao' ? 'ì¹´ì¹´ì˜¤' : 'êµ¬ê¸€';

      modalBody.innerHTML = `
        <div class="info-row">
          <div class="info-label">ì•„ì´ë””</div>
          <div class="info-value">${member.userId || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">ì´ë¦„</div>
          <div class="info-value">${member.name || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">ì´ë©”ì¼</div>
          <div class="info-value">${member.email || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">ì „í™”ë²ˆí˜¸</div>
          <div class="info-value">${member.phone || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">íšŒì‚¬ìœ í˜•</div>
          <div class="info-value">${member.companyType || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">íšŒì‚¬ëª…</div>
          <div class="info-value">${member.companyName || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">ê°€ì…ë°©ì‹</div>
          <div class="info-value">${providerText}</div>
        </div>
        <div class="info-row">
          <div class="info-label">ì•½ê´€ë™ì˜</div>
          <div class="info-value">${member.agreeTerms ? 'ë™ì˜' : 'ë¯¸ë™ì˜'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">ë§ˆì¼€íŒ…ë™ì˜</div>
          <div class="info-value">${member.agreeMarketing ? 'ë™ì˜' : 'ë¯¸ë™ì˜'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">ê°€ì…ì¼</div>
          <div class="info-value">${createdAt}</div>
        </div>
      `;

      document.getElementById('detailModal').classList.add('active');
    }

    // ëª¨ë‹¬ ë‹«ê¸°
    function closeModal() {
      document.getElementById('detailModal').classList.remove('active');
      selectedMemberId = null;
    }

    // íšŒì› ì‚­ì œ
    function deleteMember() {
      if (!selectedMemberId) return;

      if (!confirm('ì •ë§ ì´ íšŒì›ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        return;
      }

      try {
        allMembers = allMembers.filter(m => m.id !== selectedMemberId);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(allMembers));
        
        updateStats();
        filterMembers();
        closeModal();
        alert('íšŒì›ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
      } catch (error) {
        console.error('íšŒì› ì‚­ì œ ì˜¤ë¥˜:', error);
        alert('íšŒì› ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    }

    // í•„í„° ì´ˆê¸°í™”
    function resetFilters() {
      document.getElementById('searchInput').value = '';
      document.getElementById('providerFilter').value = '';
      document.getElementById('sortSelect').value = 'createdAt-desc';
      currentSort = { field: 'createdAt', order: 'desc' };
      filterMembers();
    }

    // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
    function exportData() {
      if (filteredMembers.length === 0) {
        alert('ë‹¤ìš´ë¡œë“œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }

      // CSV í˜•ì‹ìœ¼ë¡œ ë³€í™˜
      const headers = ['ë²ˆí˜¸', 'ì•„ì´ë””', 'ì´ë¦„', 'ì´ë©”ì¼', 'ì „í™”ë²ˆí˜¸', 'íšŒì‚¬ìœ í˜•', 'íšŒì‚¬ëª…', 'ê°€ì…ë°©ì‹', 'ê°€ì…ì¼'];
      const rows = filteredMembers.map((member, index) => {
        const provider = !member.provider || member.provider === 'null' ? 'ì¼ë°˜' : 
                        member.provider === 'naver' ? 'ë„¤ì´ë²„' :
                        member.provider === 'kakao' ? 'ì¹´ì¹´ì˜¤' : 'êµ¬ê¸€';
        const createdAt = member.createdAt ? new Date(member.createdAt).toLocaleString('ko-KR') : '-';
        
        return [
          index + 1,
          member.userId || '',
          member.name || '',
          member.email || '',
          member.phone || '',
          member.companyType || '',
          member.companyName || '',
          provider,
          createdAt
        ];
      });

      const csvContent = [
        headers.join(','),
        ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
      ].join('\n');

      // BOM ì¶”ê°€ (í•œê¸€ ê¹¨ì§ ë°©ì§€)
      const BOM = '\uFEFF';
      const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `íšŒì›ëª©ë¡_${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    document.getElementById('detailModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });
  </script>
</body>
</html>

