<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<title>FAQ 관리 | M&A STATION</title>
<link rel="stylesheet" href="https://macomaex.com/backoffice/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://macomaex.com/backoffice/build/css/custom.min.css" rel="stylesheet">
<style>
  .admin-container {
    padding: 20px;
    max-width: 1400px;
    margin: 0 auto;
  }
  .board-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }
  .btn-primary {
    background: #4db7ff;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    color: white;
    cursor: pointer;
  }
  .board-table {
    width: 100%;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  .board-table th {
    background: #f5f5f5;
    padding: 15px;
    text-align: left;
    font-weight: 600;
  }
  .board-table td {
    padding: 15px;
    border-top: 1px solid #eee;
  }
  .board-table tr:hover {
    background: #f9f9f9;
  }
  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    overflow-y: auto;
    padding: 20px;
  }
  .modal-content {
    background: white;
    max-width: 800px;
    margin: 0 auto;
    padding: 30px;
    border-radius: 12px;
  }
  .form-group {
    margin-bottom: 20px;
  }
  .form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
  }
  .form-group input,
  .form-group textarea,
  .form-group select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
  }
  .form-group textarea {
    min-height: 200px;
    resize: vertical;
  }
</style>
</head>
<body>
  <div class="admin-container">
    <div class="board-header">
      <h2>FAQ 관리</h2>
      <button class="btn-primary" onclick="openAddModal()">+ 새 FAQ 등록</button>
    </div>

    <table class="board-table">
      <thead>
        <tr>
          <th style="width: 80px;">순서</th>
          <th>카테고리</th>
          <th>질문</th>
          <th style="width: 120px;">관리</th>
        </tr>
      </thead>
      <tbody id="faqList">
        <tr>
          <td colspan="4" style="text-align: center; padding: 40px;">등록된 FAQ가 없습니다.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- 등록/수정 모달 -->
  <div id="faqModal" class="modal">
    <div class="modal-content">
      <h3 id="modalTitle">새 FAQ 등록</h3>
      <form id="faqForm" onsubmit="saveFaq(event)">
        <input type="hidden" id="faqId">
        <div class="form-group">
          <label>카테고리</label>
          <select id="faqCategory">
            <option value="">선택하세요</option>
            <option value="회원가입/로그인">회원가입/로그인</option>
            <option value="M&A 등록">M&A 등록</option>
            <option value="결제/멤버십">결제/멤버십</option>
            <option value="기타">기타</option>
          </select>
        </div>
        <div class="form-group">
          <label>순서</label>
          <input type="number" id="faqOrder" value="0" min="0">
        </div>
        <div class="form-group">
          <label>질문 *</label>
          <input type="text" id="faqQuestion" required>
        </div>
        <div class="form-group">
          <label>답변 *</label>
          <textarea id="faqAnswer" required></textarea>
        </div>
        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
          <button type="button" onclick="closeModal()" style="padding: 10px 20px; border: 1px solid #ddd; background: white; border-radius: 6px; cursor: pointer;">취소</button>
          <button type="submit" class="btn-primary">저장</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    const FAQ_STORAGE_KEY = 'mna_station_faqs';

    function loadFaqs() {
      const faqs = JSON.parse(localStorage.getItem(FAQ_STORAGE_KEY) || '[]');
      const tbody = document.getElementById('faqList');
      
      if (faqs.length === 0) {
        tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 40px;">등록된 FAQ가 없습니다.</td></tr>';
        return;
      }

      faqs.sort((a, b) => (a.order || 0) - (b.order || 0));

      tbody.innerHTML = faqs.map((item) => {
        return `
          <tr>
            <td>${item.order || 0}</td>
            <td>${item.category || '기타'}</td>
            <td>${item.question || '(질문 없음)'}</td>
            <td>
              <button onclick="editFaq('${item.id}')" style="padding: 5px 10px; background: #4db7ff; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 5px;">수정</button>
              <button onclick="deleteFaq('${item.id}')" style="padding: 5px 10px; background: #ff5757; color: white; border: none; border-radius: 4px; cursor: pointer;">삭제</button>
            </td>
          </tr>
        `;
      }).join('');
    }

    function openAddModal() {
      document.getElementById('faqId').value = '';
      document.getElementById('faqCategory').value = '';
      document.getElementById('faqOrder').value = '0';
      document.getElementById('faqQuestion').value = '';
      document.getElementById('faqAnswer').value = '';
      document.getElementById('modalTitle').textContent = '새 FAQ 등록';
      document.getElementById('faqModal').style.display = 'block';
    }

    function editFaq(id) {
      const faqs = JSON.parse(localStorage.getItem(FAQ_STORAGE_KEY) || '[]');
      const item = faqs.find(f => f.id === id);
      if (!item) return;

      document.getElementById('faqId').value = id;
      document.getElementById('faqCategory').value = item.category || '';
      document.getElementById('faqOrder').value = item.order || 0;
      document.getElementById('faqQuestion').value = item.question || '';
      document.getElementById('faqAnswer').value = item.answer || '';
      document.getElementById('modalTitle').textContent = 'FAQ 수정';
      document.getElementById('faqModal').style.display = 'block';
    }

    function saveFaq(event) {
      event.preventDefault();
      const faqs = JSON.parse(localStorage.getItem(FAQ_STORAGE_KEY) || '[]');
      const id = document.getElementById('faqId').value;
      
      const faqData = {
        id: id || 'faq_' + Date.now(),
        category: document.getElementById('faqCategory').value || '기타',
        order: parseInt(document.getElementById('faqOrder').value) || 0,
        question: document.getElementById('faqQuestion').value,
        answer: document.getElementById('faqAnswer').value
      };

      if (id) {
        const index = faqs.findIndex(f => f.id === id);
        if (index !== -1) {
          faqs[index] = faqData;
        }
      } else {
        faqs.push(faqData);
      }

      localStorage.setItem(FAQ_STORAGE_KEY, JSON.stringify(faqs));
      loadFaqs();
      closeModal();
      alert('저장되었습니다.');
    }

    function deleteFaq(id) {
      if (!confirm('정말 삭제하시겠습니까?')) return;
      
      const faqs = JSON.parse(localStorage.getItem(FAQ_STORAGE_KEY) || '[]');
      const filtered = faqs.filter(f => f.id !== id);
      localStorage.setItem(FAQ_STORAGE_KEY, JSON.stringify(filtered));
      loadFaqs();
      alert('삭제되었습니다.');
    }

    function closeModal() {
      document.getElementById('faqModal').style.display = 'none';
    }

    document.getElementById('faqModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    loadFaqs();
  </script>
</body>
</html>

